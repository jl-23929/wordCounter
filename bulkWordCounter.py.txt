from docx import Document
import os
import sys

def count_words_in_docx(doc_path):
    # Open the Word document
    doc = Document(doc_path)
    
    # Initialize the word count
    word_count = 0
    
    # Iterate through paragraphs in the document
    for para in doc.paragraphs:
        word_count += len(para.text.split())
    
    return word_count

def process_folder(folder_path):
    # Verify if the folder path exists
    if not os.path.isdir(folder_path):
        print(f"The folder path '{folder_path}' does not exist.")
        sys.exit(1)

    # Iterate through all files in the folder
    for filename in os.listdir(folder_path):
        if filename.endswith(".docx"):
            doc_path = os.path.join(folder_path, filename)
            try:
                word_count = count_words_in_docx(doc_path)
                print(f"{filename}: {word_count} words")
            except Exception as e:
                print(f"An error occurred while processing '{filename}': {e}")

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python count_words_folder.py <path_to_folder>")
        sys.exit(1)
    
    folder_path = sys.argv[1]
    process_folder(folder_path)
